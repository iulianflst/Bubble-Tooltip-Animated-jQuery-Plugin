(function(e){e.fn.flstBubble=function(t){function u(){a();e("#"+r.id).show();e("#"+i).fadeIn({duration:r.duration,complete:function(){e("#"+s).fadeIn({duration:r.duration,complete:function(){e("#"+r.id+" .flst-msg").fadeIn(r.duration)}})}})}function a(){e("#"+r.id+" #"+i).hide();e("#"+r.id+" #"+s).hide();e("#"+r.id+" .flst-msg").hide();e("#"+r.id+"").hide()}function f(){if(r.wizard.length>0){var t=r.wizard[r.startWizardFrom];l(e(t).attr("title"),t);e(t).removeAttr("title");r.startWizardFrom++;if(r.startWizardFrom==r.wizard.length){r.startWizardFrom=-1}}}function l(t,n){var o=e(document).width();var a=e(document).outerHeight();e("#"+r.id+" .flst-msg").html(t);var f=e(n).offset();u();e("#"+r.id+"").css({left:f.left,top:f.top-c(e(n).outerHeight())});if(f.top-c(e(n).outerHeight())<0&&f.left+h(e(n).outerWidth())<o){e("#"+r.id+"").css("top",f.top+e(n).outerHeight());e("#"+r.id+" .flst-msg").css({top:45,left:20});e("#"+i).css({top:0,left:0});e("#"+s).css({top:15,left:10})}else if(f.top+c(e(n).outerHeight())>a&&f.left+h(e(n).outerWidth())>o){var l=h(0);e("#"+r.id).css({left:f.left-l,top:f.top-c(0)});e("#"+r.id+" .flst-msg").css({top:0,left:-15});e("#"+i).css({top:25+e("#"+r.id+" .flst-msg").outerHeight(),left:l});e("#"+s).css({top:0+e("#"+r.id+" .flst-msg").outerHeight(),left:l-25})}else if(f.left+h(e(n).outerWidth())>=o){e("#"+r.id+"").css({top:f.top+e(n).outerHeight(),left:f.left-h(0)});e("#"+r.id+" .flst-msg").css({top:50,left:10});e("#"+i).css({top:0,left:h(0)});e("#"+s).css({top:20,left:h(0)-10})}else{e("#"+r.id).css({left:f.left,top:f.top-c(0)});e("#"+r.id+" .flst-msg").css({top:0,left:20});e("#"+i).css({top:25+e("#"+r.id+" .flst-msg").outerHeight(),left:0});e("#"+s).css({top:0+e("#"+r.id+" .flst-msg").outerHeight(),left:10})}if(r.wizard&&r.autoscroll){var p=e(n).offset().top;if(e(n).offset().top>e("#"+r.id).offset().top){p=e("#"+r.id).offset().top}e("html, body").animate({scrollTop:p},1e3)}}function c(t){return e("#"+r.id+" .flst-msg").outerHeight()+e("#"+r.id+" #"+i).outerHeight()+e("#"+r.id+" #"+s).outerHeight()+t}function h(t){return e("#"+r.id+" .flst-msg").outerWidth()}var n=new Array;var r=e.extend({id:"flstBubble-strct",duration:200,wizard:false,autoscroll:false,startWizardFrom:0,showOnlyOnWizard:false,useWizard:true,onFinishWizard:false,theme:false},t);var i=r.id+"b1";var s=r.id+"b2";if(jQuery.isPlainObject(r.theme)){e(document).ready(function(){e("#"+r.id+" .flst-msg, #"+i+", #"+s).css({background:r.theme.background,color:r.theme.color})})}if(e("body #"+r.id).length==0){var o='<div id="'+r.id+'" class="flstBubble-strct">';o+='<div class="flst-msg">no text</div>';o+='<div class="bbl1" id="'+i+'"> </div>';o+='<div class="bbl2" id="'+s+'"> </div>';o+="</div>";e("body").append(o)}a();if(r.useWizard){f();e("#"+r.id+" .flst-msg").bind("click",function(e){if(r.startWizardFrom==-1){if(r.onFinishWizard)r.onFinishWizard();a()}else{f()}})}if(!r.showOnlyOnWizard){this.each(function(t){e(this).bind("mouseover",{title:e(this).attr("title")},function(e){l(e.data.title,this)});e(this).bind("mouseout",{title:e(this).attr("title")},function(e){a()});e(this).removeAttr("title")})}return this}})(jQuery)